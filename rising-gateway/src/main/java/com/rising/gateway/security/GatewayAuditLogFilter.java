package com.rising.gateway.security;import lombok.extern.slf4j.Slf4j;import org.apache.commons.lang3.StringUtils;import org.springframework.security.core.context.SecurityContextHolder;import org.springframework.web.filter.OncePerRequestFilter;import javax.servlet.FilterChain;import javax.servlet.ServletException;import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpServletResponse;import java.io.IOException;import java.util.Map;/** * 网关审计日志过滤器 * * @author meet * @date 2020/08/19 */@Slf4jpublic class GatewayAuditLogFilter extends OncePerRequestFilter {    @Override    protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain filterChain)            throws ServletException, IOException {        String user = (String) SecurityContextHolder.getContext().getAuthentication().getPrincipal();        log.info("请求路径>>>>>>>{}", request.getRequestURI());        log.info("1. add log for >>>>>>>>>>>{}", user);        log.info("请求方法{},请求地址{}", request.getMethod(), request.getRemoteAddr());        Map<String, String[]> parameterMap = request.getParameterMap();        for (String s : parameterMap.keySet()) {            log.info("请求参数{}",s);        }        filterChain.doFilter(request, response);        if (StringUtils.isBlank((String) request.getAttribute("logUpdated"))) {            log.info("3. update log to success");        }    }}